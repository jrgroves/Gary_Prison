# Arizona Department of Corrections, Rehabilitation & Reentry (ADCRR) Inmate Research
# Differences Between Male & Female Inmates 
# May 25 -27, 2023
# Brenda Gary

"Master_DemoSentenceCrime final R file that contains the gender, race, crime categories, projected time served variables,"
"removes duplicates, removes missing info/NA obs., etc"

rm(list=ls())

setwd("D:/PhD/Research!/Male_Female/Empirical/AZMergedDemoSentenceCrime_MF/Originals/gary_CopyCSV_MF/CreatedMaster_DSC_CorrectCrimeAndEthnicityetc")

load("D:/PhD/Research!/Male_Female/Empirical/AZMergedDemoSentenceCrime_MF/Originals/gary_CopyCSV_MF/CreatedMaster_DSC_CorrectCrimeAndEthnicityetc/MasterStack_DemoSentenceCrime_CorrectDates.RData")
"67,074 observations & 45 variables"

"Update: 5/27/23 - Remove ALL of the irrelevent variables in the data set"
# Remove irrelevant variables
data.2 <- subset(MasterStack_DemoSentenceCrime_CorrectDates, select = 
                   -c(Middle.Initial,  Hair.Color, Eye.Color, Verified, Ruling))
"567,074 obs. & 40 variables
"

"//////////////////////// Create Male & Female Dummy Variable /////////////////////////////////////////////////"

"Create Dummy Variable for Males and Females"
# Male = 1 & 0 = females
data.2$male <- ifelse(data.2$Gender == "MALE", 1, 0)
# 41 vars. & 567,074 obs.
#494,987 Males & 72,087 - 87.29% M & 12.71% F


"///////////////////////////// Remove 2 Observations With NA Ethnicity //////////////////////////////////////////////"

# Identify rows with missing information in Ethnic.Origin column
missing_rows <- which(is.na(data.2$Ethnic.Origin))

# Remove rows with missing information in Ethnic.Origin column
data.3 <- data.2[!is.na(data.2$Ethnic.Origin), ]
"567,072 & 41 variables -- 2 observations were removed!"


" ///////////////////////////// Create Ethnicity Dummy Variables /////////////////////////////////////////////////////////"

# Create the Ethnic Origin - Race Category
data.3$white <- ifelse(data.3$Ethnic.Origin  == "CAUCASIAN", 1, 0)
data.3$black  <- ifelse(data.3$Ethnic.Origin == "BLACK", 1, 0)
data.3$mex_amer <- ifelse(data.3$Ethnic.Origin == "MEXICAN AMERICAN", 1,0) 
data.3$mex_nat <- ifelse(data.3$Ethnic.Origin == "MEXICAN NATIONAL", 1, 0)
data.3$native  <- ifelse(data.3$Ethnic.Origin == "NATIVE INDIAN", 1, 0)
data.3$asian  <- ifelse(data.3$Ethnic.Origin == "ASIAN", 1, 0)
data.3$other <- ifelse(data.3$Ethnic.Origin %in% c("UNKNOWN", "OTHER"), 1, 0)
"48 variables & 567,072 observations"

#summary(data.3)
#////////////////////////// Remove Duplicate Observations //////////////////////////////////////////////////////////////////////

"Remove Duplicate Observations"
# Using dplyr
library(dplyr)
# Remove duplicate rows (all columns)
data.1_dups <- data.3 %>% distinct()
"567,072 observations"
"567,060 observations"
"12 observations were removed!"
"But investigating a little further, there is still 4 inmate ID# 80038 that still appear in the dataset"

"Remove inmate ID# 80038 & save that dataset so dont have to run duplicated code again"
# 2/7/23: The original appears, plus he's in position 495201-495204. Remove them.

"Delete based on index (position in the data frame)"
# https://www.marsja.se/how-to-remove-delete-row-in-r-with-na-with-conditions-duplicated/
data.22 <- data.1_dups[-295401, ]
data.33 <- data.22[-295402, ]
data.44 <- data.33[-295402, ]
#data.4 <- data.3[-295404, ]
#data.5 <- data.4[-295402, ]
#data.6 <- data.5[-295402, ]
"The rest of the duplicates for ID # 80038 are removed except one!!! How to remove this last duplicate?"

data.5 <- data.44 %>% distinct() #No observations were removed but need this step before doing the next & final one
data.6 <- data.5[-295401, ]

"567,056 Obs. & 48 vars."

#summary(data.6)
"//////////////////////// Remove Missing Observations //////////////////////////////////////////////////////"
"Rename Data Set"
DSC <- data.6

# Identify rows with missing information in specified columns
missing_rows <- which(is.na(DSC$Commit.) & is.na(DSC$Sentence.yy.mm.dd.x) &
                        is.na(DSC$Sentence.County) & is.na(DSC$Court.Cause.)& is.na(DSC$Court.Cause.)& is.na(DSC$Offense.Date)
                      & is.na(DSC$Sentence.Status)& is.na(DSC$Crime)& is.na(DSC$Crime.Info)& is.na(DSC$Felony.Class)
                      & is.na(DSC$Admit.Date)& is.na(DSC$Consec..Concur)& is.na(DSC$Release.Date.s)& is.na(DSC$Supervision.End)
                      & is.na(DSC$Sentence.Expiration)& is.na(DSC$Flat.Maximum))

# Remove rows with missing information
DSC_clean <- DSC[-missing_rows, ]
"Before: 567,056 obs."
"After: 566,703 observations"
"Thus,only 353 inmates met the criteria and were removed! Perfect! There were 365 NA's for crime alone and now 355 have been removed successfully!!!"

"//////////////////////// Remove More Observations With Missing Info //////////////////////////////////////////////////////"

"Next, have to remove some of the inmates that are still missing info-
such as ID #80152 because of the missing info for the first crime & also the illogical admit & release date for inmate ID # "
# There are only 2 inmates (102899 & 080547) that show past release.date.s as opposed to the correct future dates

"Remove the following inmate ID #s 80152, 102899, 80547 from this dataset"
DSC_clean.2 <- subset(DSC_clean, ID!=80152)
# 8 observations should be removed
# 566703-566695 = 8!!! - Successfully removed!

"Remove the following inmate ID #s 80152, 102899, 80547 from this dataset"
DSC_clean.3 <- subset(DSC_clean.2, ID!=102899)
# 1 observations should be removed
# 566695 - 566694 = 1!!! - Successfully removed!

"Remove the following inmate ID #s 80152, 102899, 80547 from this dataset"
DSC_clean.4 <- subset(DSC_clean.3, ID!=80547)
# 4 observations should be removed
# 566694-566690= 4!!! - Successfully removed!

"Original observations = 567,056"
"Observations after removing inmates with missing information = 566,690"
"Thus, a total of 368 observations removed!"

"//////////////////////// Create Crime Dummy Variables /////////////////////////////////////////"

library(forcats)

"Step 1: Convert the Crime (character) to a Factor variable"
DSC_clean.4$Crime_Factor <- as.factor(DSC_clean.4$Crime) 
# 49 variables

"Step 2: Collapse the 789 levels down to 17 crime categories"

DSC_clean.4$Crime_Collapse <- fct_collapse(DSC_clean.4$Crime_Factor,
                                      Arson = c("ARSON OF OCCUPD JAIL/PRSN","ARSON OF OCCUPD STRUCTURE", "ARSON OF STRUCTURE/PROPRTY","ATTEMPT TO COMMIT ARSON OF OCCUPD JAIL/PRSN","ATTEMPT TO COMMIT ARSON OF OCCUPD STRUCTURE","ATTEMPT TO COMMIT ARSON OF STRUCTURE/PROPRTY","ATTEMPT TO COMMIT BURNING OF WILDLANDS","ATTEMPT//OLD CODE ARSON OF OCCUPD JAIL/PRSN","ATTEMPT//OLD CODE ARSON OF OCCUPD STRUCTURE","ATTEMPT//OLD CODE ARSON OF STRUCTURE/PROPRTY","BURNING OF WILDLANDS","CONSPIRACY ARSON OF OCCUPD STRUCTURE","CONSPIRACY ARSON OF STRUCTURE/PROPRTY","SOLICITATION ARSON OF OCCUPD STRUCTURE","SOLICITATION ARSON OF STRUCTURE/PROPRTY"),
                                      Assault = c("RIOT","ATTEMPT TO COMMIT RIOT","ATTEMPT//OLD CODE RIOT","AGG ASSAULT PEACE OFFICER","AGGRAVATED ASSAULT","ASLT-INCT/PRTICIPATE-RIOT","ASSAULT","ASSAULT-VICIOUS ANIMAL","ASSAULT W DEADLY WEAPON","ATTEMPT TO COMMIT AGGRAVATED ASSAULT","ATTEMPT TO COMMIT ASLT-INCT/PRTICIPATE-RIOT","ATTEMPT TO COMMIT ASSAULT","ATTEMPT TO COMMIT CRIMES AGAINST DEAD PRSN","ATTEMPT TO COMMIT DANG/DEADLY ASLT BY PRSNR","ATTEMPT TO COMMIT DRIVE BY SHOOTING","ATTEMPT TO COMMIT DSCHG FIREARM AT A STRCTRE","ATTEMPT TO COMMIT DSCHRG FIREARM IN CITY LMT","ATTEMPT TO COMMIT ENDANGERMENT","ATTEMPT TO COMMIT THREAT-INTIMIDATE","ATTEMPT TO COMMIT UNLAW ADMIN LIQUOR/DRUG","ATTEMPT//OLD CODE AGGRAVATED ASSAULT","ATTEMPT//OLD CODE ASLT-INCT/PRTICIPATE-RIOT","ATTEMPT//OLD CODE DANG/DEADLY ASLT BY PRSNR","ATTEMPT//OLD CODE DRIVE BY SHOOTING","ATTEMPT//OLD CODE ENDANGERMENT","ATTEMPT//OLD CODE THREAT-INTIMIDATE","CONSPIRACY AGGRAVATED ASSAULT","CONSPIRACY ASSAULT","CONSPIRACY DANG/DEADLY ASLT BY PRSNR","CONSPIRACY DRIVE BY SHOOTING","CONSPIRACY DSCHG FIREARM AT A STRCTRE","CONSPIRACY ENDANGERMENT","CONSPIRACY THREAT-INTIMIDATE","DANG/DEADLY ASLT BY PRSNR","DRIVE BY SHOOTING","DSCHG FIREARM AT A STRCTRE","DSCHRG FIREARM IN CITY LMT","ENDANGERMENT","FACILITATION AGGRAVATED ASSAULT","FACILITATION ASLT-INCT/PRTICIPATE-RIOT","FACILITATION DANG/DEADLY ASLT BY PRSNR","FACILITATION DRIVE BY SHOOTING","FACILITATION DSCHG FIREARM AT A STRCTRE","INTIMD/THRT/HARRAS W/PHN","MUTILAT/DISINTER DEAD BODY","PRSNR ASSLT W/BODY FLUIDS","SERIOUS PHYS INJURY BY VEH","SOLICITATION AGGRAVATED ASSAULT","SOLICITATION ASLT-INCT/PRTICIPATE-RIOT","SOLICITATION DRIVE BY SHOOTING","SOLICITATION DSCHG FIREARM AT A STRCTRE","SOLICITATION DSCHRG FIREARM IN CITY LMT","SOLICITATION ENDANGERMENT","SOLICITATION THREAT-INTIMIDATE","THREAT-INTIMIDATE","UNLAW ADMIN LIQUOR/DRUG"),
                                      Burglary_CriminalTrespass_Theft_CriminalDamage = c("ATTEMPT TO COMMIT BURGLARY","ATTEMPT TO COMMIT BURGLARY 1ST DEGREE","ATTEMPT TO COMMIT BURGLARY 2ND DEGREE","ATTEMPT TO COMMIT BURGLARY 3RD DEGREE","ATTEMPT TO COMMIT CRIMINAL TRESPASS 1ST DGR","ATTEMPT//OLD CODE BURGLARY 1ST DEGREE","ATTEMPT//OLD CODE BURGLARY 2ND DEGREE","ATTEMPT//OLD CODE BURGLARY 3RD DEGREE","BURGLARY","BURGLARY 1ST DEGREE","BURGLARY 2ND DEGREE","BURGLARY 3RD DEGREE","BURGLARY TOOLS POSSESSION","CONSPIRACY BURGLARY 1ST DEGREE","CONSPIRACY BURGLARY 2ND DEGREE","CONSPIRACY BURGLARY 3RD DEGREE","CONSPIRACY BURGLARY TOOLS POSSESSION","CONSPIRACY CRIMINAL TRESPASS 1ST DGR","CRIMINAL TRESPASS 1ST DGR","CRIMINAL TRESPASS 2ND DEGR","CRIMINAL TRESPASS 3RD DEGR","FACILITATION BURGLARY 1ST DEGREE","FACILITATION BURGLARY 2ND DEGREE","FACILITATION BURGLARY 3RD DEGREE","FACILITATION CRIMINAL TRESPASS 1ST DGR","SOLICITATION BURGLARY 1ST DEGREE","SOLICITATION BURGLARY 2ND DEGREE","SOLICITATION BURGLARY 3RD DEGREE","SOLICITATION BURGLARY TOOLS POSSESSION","AGGRAVATED CRIMINAL DAMAGE","ATTEMPT TO COMMIT AGGRAVATED CRIMINAL DAMAGE","ATTEMPT TO COMMIT CRIMINAL DAMAGE","ATTEMPT TO COMMIT DESTRUCTION OF PUBLIC JAIL","ATTEMPT//OLD CODE AGGRAVATED CRIMINAL DAMAGE","ATTEMPT//OLD CODE CRIMINAL DAMAGE","ATTEMPT//OLD CODE DESTRUCTION OF PUBLIC JAIL","CONSPIRACY CRIMINAL DAMAGE","CONSPIRACY DESTRUCTION OF PUBLIC JAIL","CRIMINAL DAMAGE","CRIMNL LITTERING/POLLUTING","DAMAGE TO PROPERTY PRIVATE","DESTRUCTION OF PUBLIC JAIL","SOLICITATION AGGRAVATED CRIMINAL DAMAGE","SOLICITATION CRIMINAL DAMAGE", "ATTEMPT TO COMMIT FAIL RTRN VEH-SECURITY/NT","ATTEMPT TO COMMIT ORGANIZED RETAIL THEFT","ATTEMPT TO COMMIT SHOPLIFTING","ATTEMPT TO COMMIT THEFT","ATTEMPT TO COMMIT THEFT BY EXTORTION","ATTEMPT TO COMMIT THEFT CREDIT CARD","ATTEMPT TO COMMIT THFT MEANS OF TRNSPRTATION","ATTEMPT TO COMMIT UNLAW COPY/SLE SNDS/IMGES","ATTEMPT TO COMMIT UNLAW FAIL RTRN RENTD PROP","ATTEMPT TO COMMIT UNLAW USE OF MEANS OF TRNS","ATTEMPT TO COMMIT UNLAWFUL USE POWER OF ATT.","ATTEMPT TO COMMIT UNLAWFUL USE THEFT DET. DV","ATTEMPT//OLD CODE ORGANIZED RETAIL THEFT","ATTEMPT//OLD CODE SHOPLIFTING","ATTEMPT//OLD CODE THEFT","ATTEMPT//OLD CODE THEFT BY EXTORTION","ATTEMPT//OLD CODE THFT MEANS OF TRNSPRTATION","ATTEMPT//OLD CODE UNLAW USE OF MEANS OF TRNS","CONSPIRACY ORGANIZED RETAIL THEFT","CONSPIRACY SHOPLIFTING","CONSPIRACY THEFT","CONSPIRACY THEFT BY EXTORTION","CONSPIRACY THFT MEANS OF TRNSPRTATION","CONSPIRACY UNLAW USE OF MEANS OF TRNS","CONSPIRACY UNLAWFUL USE THEFT DET. DV","FACILITATION ORGANIZED RETAIL THEFT","FACILITATION SHOPLIFTING","FACILITATION THEFT","FACILITATION THEFT BY EXTORTION","FACILITATION THFT MEANS OF TRNSPRTATION","FACILITATION UNLAW COPY/SLE SNDS/IMGES","FAIL RTRN VEH-SECURITY/NT","ISSUING BAD CHECK","ORGANIZED RETAIL THEFT","SHOPLIFTING","SOLICITATION ORGANIZED RETAIL THEFT","SOLICITATION SHOPLIFTING","SOLICITATION THEFT","SOLICITATION THEFT BY EXTORTION","SOLICITATION THFT MEANS OF TRNSPRTATION","SOLICITATION UNLAW COPY/SLE SNDS/IMGES","SOLICITATION UNLAW USE OF MEANS OF TRNS","STOLEN PROPERTY","THEFT","THEFT BY EXTORTION","THEFT CRDT CRD OBT FRAUD","THEFT CREDIT CARD","THFT MEANS OF TRNSPRTATION","UNLAW COPY/SLE SNDS/IMGES","UNLAW FAIL RTRN RENTD PROP","UNLAW USE OF MEANS OF TRNS","UNLAWFUL USE POWER OF ATT.","UNLAWFUL USE SALES RECEIPT","UNLAWFUL USE THEFT DET. DV"),
                                      DomesticViolence_ChildAdultAbuse =c("AGGRAV. DOMESTIC VIOLENCE","ATTEMPT TO COMMIT AGGRAV. DOMESTIC VIOLENCE","ATTEMPT TO COMMIT DOMESTIC VIOLENCE","ATTEMPT//OLD CODE AGGRAV. DOMESTIC VIOLENCE","ATTEMPT//OLD CODE DOMESTIC VIOLENCE","CONSPIRACY AGGRAV. DOMESTIC VIOLENCE","DOMESTIC VIOLENCE","SOLICITATION AGGRAV. DOMESTIC VIOLENCE", "ATTEMPT TO COMMIT CHILD/ADULT ABUSE","ATTEMPT//OLD CODE CHILD/ADULT ABUSE","CHILD/ADULT ABUSE","CONSPIRACY CHILD/ADULT ABUSE","FACILITATION CHILD/ADULT ABUSE","SOLICITATION CHILD/ADULT ABUSE"),
                                      DrugOffenses_All =c("ATTEMPT TO COMMIT CONTROLLED SUBSTANCE VIOL","ATTEMPT TO COMMIT DANGEROUS DRUG VIOLATION","ATTEMPT TO COMMIT DRUG FREE SCHL ZONE VIOL","ATTEMPT TO COMMIT DRUG PARAPHERNALIA VIOLAT","ATTEMPT TO COMMIT INVLV/USE MNR IN DRUG OFFN","ATTEMPT TO COMMIT NARCOTIC DRUG VIOLATION","ATTEMPT TO COMMIT POSSESS & SELL INHALENT","ATTEMPT TO COMMIT POSSESSION & SALE NARCOTIC","ATTEMPT TO COMMIT POSSESSN & SALE DANG.DRUG","ATTEMPT TO COMMIT PRCRSR/REGULTD CHEM VIOL","ATTEMPT TO COMMIT PRECURSOR CHEM-NONREPORT","ATTEMPT TO COMMIT PRSCRPTION-ONLY DRUG VIOL","ATTEMPT TO COMMIT USE BLDG FOR DRUG SALE/MFG","ATTEMPT TO COMMIT USE ELEC COMM DRUG TRANS","ATTEMPT//OLD CODE DANGEROUS DRUG VIOLATION","ATTEMPT//OLD CODE DRUG PARAPHERNALIA VIOLAT","ATTEMPT//OLD CODE INVLV/USE MNR IN DRUG OFFN","ATTEMPT//OLD CODE NARCOTIC DRUG VIOLATION","ATTEMPT//OLD CODE POSSESSION & SALE NARCOTIC","ATTEMPT//OLD CODE PRSCRPTION-ONLY DRUG VIOL","ATTEMPT//OLD CODE USE ELEC COMM DRUG TRANS","CONSPIRACY DANGEROUS DRUG VIOLATION","CONSPIRACY DRUG PARAPHERNALIA VIOLAT","CONSPIRACY INVLV/USE MNR IN DRUG OFFN","CONSPIRACY NARCOTIC DRUG VIOLATION","CONSPIRACY POSSESSION & SALE NARCOTIC","CONSPIRACY POSSESSN & SALE DANG.DRUG","CONSPIRACY PRECURSOR CHEM-NONREPORT","CONSPIRACY PRSCRPTION-ONLY DRUG VIOL","CONSPIRACY USE ELEC COMM DRUG TRANS","CONTROLLED SUBSTANCE VIOL","DANGEROUS DRUG VIOLATION","DRUG FREE SCHL ZONE VIOL","DRUG PARAPHERNALIA VIOLAT","DRUGS","FACILITATION DANGEROUS DRUG VIOLATION","FACILITATION DRUG FREE SCHL ZONE VIOL","FACILITATION DRUG PARAPHERNALIA VIOLAT","FACILITATION INVLV/USE MNR IN DRUG OFFN","FACILITATION MARIJUANA VIOLATION","FACILITATION NARCOTIC DRUG VIOLATION","FACILITATION POSSESSION & SALE NARCOTIC","FACILITATION PRCRSR/REGULTD CHEM VIOL","FACILITATION PRSCRPTION-ONLY DRUG VIOL","FACILITATION USE ELEC COMM DRUG TRANS","IMIT CTRL SBST/MFG/DISTRIB","IMIT OVER CNTR DRG MFG/DST","IMIT PRSC-ONLY DRG MFG/DST","INVLV/USE MNR IN DRUG OFFN","NARCOTIC DRUG VIOLATION","PHARMACY VIOLATION","POSSESS & SELL INHALENT","POSSESS & SELL PEYOTE","POSSESSION & SALE NARCOTIC","POSSESSION OF NARCOTIC","POSSESSN & SALE DANG.DRUG","PRCRSR/REGULTD CHEM VIOL","PRECURSOR CHEM-NONREPORT","PRSCRPTION-ONLY DRUG VIOL","SOLICITATION CONTROLLED SUBSTANCE VIOL","SOLICITATION DANGEROUS DRUG VIOLATION","SOLICITATION DRUG PARAPHERNALIA VIOLAT","SOLICITATION INVLV/USE MNR IN DRUG OFFN","SOLICITATION NARCOTIC DRUG VIOLATION","SOLICITATION POSSESS & SELL PEYOTE","SOLICITATION POSSESSION & SALE NARCOTIC","SOLICITATION POSSESSN & SALE DANG.DRUG","SOLICITATION PRECURSOR CHEM-NONREPORT","SOLICITATION PRSCRPTION-ONLY DRUG VIOL","SOLICITATION USE ELEC COMM DRUG TRANS","USE BLDG FOR DRUG SALE/MFG","USE ELEC COMM DRUG TRANS","USE OF DRUGS ON PAROLE","ATTEMPT TO COMMIT MARIJUANA VIOLATION","ATTEMPT TO COMMIT POSSESS,SELL,MARIJUANA","ATTEMPT//OLD CODE MARIJUANA VIOLATION","CONSPIRACY MARIJUANA VIOLATION","CONSPIRACY POSSESS,SELL,MARIJUANA","MARIJUANA VIOLATION","POSSESS,SELL,MARIJUANA","SOLICITATION MARIJUANA VIOLATION"),
                                      DUI =c("AGGRAVATED DRIVING/DWI","AGGRAVATED DUI","ATTEMPT TO COMMIT AGGRAVATED DRIVING/DWI","ATTEMPT TO COMMIT AGGRAVATED DUI","ATTEMPT TO COMMIT DRIVING WHILE INTOXICATED","ATTEMPT TO COMMIT DUI LQUOR/DRUGS/VPRS/COMBO","ATTEMPT TO COMMIT DWI LICENSE SUSPEND-REVOKE","ATTEMPT//OLD CODE AGGRAVATED DUI","ATTEMPT//OLD CODE DWI LICENSE SUSPEND-REVOKE","DRIVING WHILE INTOXICATED", "DUI LQUOR/DRUGS/VPRS/COMBO","DUI W/MINOR PRESENT","DWI LICENSE SUSPEND-REVOKE","DWI LIQUOR OR DRUGS"),
                                      Escape =c("ATTEMPT TO COMMIT CONTRABAND SECURE FACILITY","ATTEMPT TO COMMIT ESCAPE FIRST DEGREE","ATTEMPT TO COMMIT ESCAPE SECOND DEGREE","ATTEMPT TO COMMIT ESCAPE THIRD DEGREE","ATTEMPT TO COMMIT FAIL TO APPEAR FIRST DEG","ATTEMPT TO COMMIT HINDER PROSECUTION 1ST DEG","ATTEMPT TO COMMIT HINDERING PROSECUTION","ATTEMPT TO COMMIT PROMOTE PRISON CONTRABAND","ATTEMPT TO COMMIT RESISTING ARREST","ATTEMPT TO COMMIT ST INMT NOT RTRN TEMP REL","ATTEMPT//OLD CODE ESCAPE SECOND DEGREE","ATTEMPT//OLD CODE FAIL TO APPEAR FIRST DEG","ATTEMPT//OLD CODE HINDER PROSECUTION 1ST DEG","ATTEMPT//OLD CODE HINDERING PROSECUTION","ATTEMPT//OLD CODE PROMOTE PRISON CONTRABAND","CONSPIRACY CONTRABAND SECURE FACILITY","CONSPIRACY ESCAPE FIRST DEGREE","CONSPIRACY ESCAPE SECOND DEGREE","CONSPIRACY HINDER PROSECUTION 1ST DEG","CONSPIRACY HINDERING PROSECUTION","CONSPIRACY PROMOTE PRISON CONTRABAND","CONTRABAND SECURE FACILITY","ESCAPE FIRST DEGREE","ESCAPE SECOND DEGREE","ESCAPE THIRD DEGREE","FACILITATION CONTRABAND SECURE FACILITY","FACILITATION HINDER PROSECUTION 1ST DEG","FACILITATION PROMOTE PRISON CONTRABAND","FAIL TO APPEAR FIRST DEG","HINDER PROSECUTION 1ST DEG","HINDERING PROSECUTION","PROMOTE PRISON CONTRABAND","RESISTING ARREST","SOLICITATION HINDER PROSECUTION 1ST DEG","SOLICITATION PROMOTE PRISON CONTRABAND","SOLICITATION RESISTING ARREST","ST INMT NOT RTRN TEMP REL"),
                                      Fraud_Frogery_IdentityTheft =c("ATTEMPT TO COMMIT FALSE STMT-OBT CREDITCARD","ATTEMPT TO COMMIT FRAUD BUY-SELL SECURITIES","ATTEMPT TO COMMIT FRAUD SCHEME/PRAC-CONCEAL","ATTEMPT TO COMMIT FRAUDULENT INSURANCE CLAIM","ATTEMPT TO COMMIT FRAUDULENT SCHEMS ARTIFICS","ATTEMPT TO COMMIT FRAUDULENT USE CREDIT CARD","ATTEMPT TO COMMIT LOTTO TCKT-ALTR TO DEFRAUD","ATTEMPT TO COMMIT OBTAIN NARCOTICS BY FRAUD","ATTEMPT TO COMMIT REC ITEM OBT BY FRD CRDCD","ATTEMPT TO COMMIT THEFT CRDT CRD OBT FRAUD","ATTEMPT TO COMMIT UNLAWFUL POSS. ACCESS DEV.","ATTEMPT//OLD CODE FRAUD SCHEME/PRAC-CONCEAL","ATTEMPT//OLD CODE FRAUDULENT SCHEMS ARTIFICS","ATTEMPT//OLD CODE FRAUDULENT USE CREDIT CARD","ATTEMPT//OLD CODE THEFT CRDT CRD OBT FRAUD","COLLECT CRDT EXTNSN-EXTORT","CONSPIRACY COLLECT CRDT EXTNSN-EXTORT","CONSPIRACY CRIMINAL SIMULATION","CONSPIRACY FRAUD BUY-SELL SECURITIES","CONSPIRACY FRAUD SCHEME/PRAC-CONCEAL","CONSPIRACY FRAUDULENT SCHEMS ARTIFICS","CONSPIRACY RACKETEERING","CRIMINAL SIMULATION","DEFRAUD SECURED CREDITORS","FACILITATION FRAUD SCHEME/PRAC-CONCEAL","FACILITATION FRAUDULENT SCHEMS ARTIFICS","FAIL TO FILE/PAY TAXES","FALSE INFO TO FINANCE INST","FALSE STMT-OBT CREDITCARD","FALSE STMT TO OBTAIN BNFTS","FINANCE EXTORT EXTENS CRDT","FRAUD","FRAUD BUY-SELL SECURITIES","FRAUD SCHEME/PRAC-CONCEAL","FRAUD TO OBTN PRESCR DRUG","FRAUD USE OF CREDIT CARD","FRAUD.FIRE INSURANCE CLAIM","FRAUDULENT INSURANCE CLAIM","FRAUDULENT SCHEMS ARTIFICS","FRAUDULENT USE CREDIT CARD","IMPRPR INFL ON PUB EMPL","LOTTO TCKT-ALTR TO DEFRAUD","MAKE EXTORT EXTENSION CRDT","OBTAIN CABLE SVC BY FRAUD","OBTAIN NARCOTICS BY FRAUD","OBTAIN UTILITY SVCS. FRAUD","PATIENT/CLIENT REFER FRAUD","POSSESS ALTERED PROPERTY","PRESENTING FALSE INS.CLAIM","RACKETEERING","REC ITEM OBT BY FRD CRDCD","RESIDENTIAL MORTGAGE FRAUD","SALE SECURITIES UNREG AGNT","SALE UNREGISTER SECURITIES","SOLICITATION FRAUD BUY-SELL SECURITIES","SOLICITATION FRAUDULENT SCHEMS ARTIFICS","SOLICITATION OBTAIN NARCOTICS BY FRAUD","SOLICITATION THEFT CRDT CRD OBT FRAUD","TELECOMMUNICATION FRAUD","UNLAW POSS/USE SCAN DEVICE","UNLAWFUL POSS. ACCESS DEV.","UNLAWFUL USE OF FOOD STAMP","UNLWFL USE FOOD STAMPS","WELFARE FRAUD/PROG DISQUAL", "AGGRAVTD TAKING IDENTITY","ATTEMPT TO COMMIT AGGRAVTD TAKING IDENTITY","ATTEMPT TO COMMIT CRIM POSS FORGERY DEVICE","ATTEMPT TO COMMIT FORGERY","ATTEMPT TO COMMIT FORGERY OF CREDIT CARDS","ATTEMPT TO COMMIT IMPERSONATE PEACE OFFICER","ATTEMPT TO COMMIT TAKING IDENITY OF ANOTHER","ATTEMPT TO COMMIT TAKING IDENTITY OF ANOTHER","ATTEMPT TO COMMIT TRAFFICKING IDENTITY","ATTEMPT//OLD CODE AGGRAVTD TAKING IDENTITY","ATTEMPT//OLD CODE CRIMINAL IMPERSONATION","ATTEMPT//OLD CODE FORGERY","ATTEMPT//OLD CODE FORGERY OF CREDIT CARDS","ATTEMPT//OLD CODE TAKING IDENITY OF ANOTHER","ATTEMPT//OLD CODE TAKING IDENTITY OF ANOTHER","ATTEMPT//OLD CODE TRAFFICKING IDENTITY","CONSPIRACY FORGERY","CONSPIRACY FORGERY OF CREDIT CARDS","CONSPIRACY TAKING IDENTITY OF ANOTHER","CONSPIRACY TRAFFICKING IDENTITY","CRIM POSS FORGERY DEVICE","CRIMINAL IMPERSONATION","FACILITATION AGGRAVTD TAKING IDENTITY","FACILITATION FORGERY","FACILITATION TAKING IDENTITY OF ANOTHER","FACILITATION TRAFFICKING IDENTITY","FORGERY","FORGERY OF CREDIT CARDS","IMPERSONATE PEACE OFFICER","POSSESS CREDIT CARD EQUIP","SOLICITATION AGGRAVTD TAKING IDENTITY","SOLICITATION CRIM POSS FORGERY DEVICE","SOLICITATION CRIMINAL IMPERSONATION","SOLICITATION FORGERY","SOLICITATION FORGERY OF CREDIT CARDS","SOLICITATION TAKING IDENTITY OF ANOTHER","SOLICITATION TRAFFICKING IDENTITY","TAKING IDENITY OF ANOTHER","TAKING IDENTITY OF ANOTHER","TRAFFICKING IDENTITY"),
                                      Kidnapping =c("ATTEMPT TO COMMIT CUSTODIAL INTERFERENCE","ATTEMPT TO COMMIT KIDNAPPING","ATTEMPT TO COMMIT UNLAWFUL IMPRISONMENT","ATTEMPT//OLD CODE CUSTODIAL INTERFERENCE","ATTEMPT//OLD CODE KIDNAPPING","CONSPIRACY CUSTODIAL INTERFERENCE","CONSPIRACY KIDNAPPING","CUSTODIAL INTERFERENCE","FACILITATION CUSTODIAL INTERFERENCE","FACILITATION KIDNAPPING","KIDNAPPING","SOLICITATION KIDNAPPING","UNLAWFUL IMPRISONMENT"),
                                      Murder_Manslaughter_NegligentHomicide =c("ATTEMPT TO COMMIT MANSLAUGHTER","ATTEMPT TO COMMIT NEGLIGENT HOMICIDE","ATTEMPT//OLD CODE MANSLAUGHTER","ATTEMPT//OLD CODE NEGLIGENT HOMICIDE","CONSPIRACY MANSLAUGHTER","MANSLAUGHTER","NEGLIGENT HOMICIDE","SOLICITATION NEGLIGENT HOMICIDE","ATTEMPT TO COMMIT MURDER 1ST DEGREE","ATTEMPT TO COMMIT MURDER 2ND DEGREE","ATTEMPT//OLD CODE MURDER 1ST DEGREE","ATTEMPT//OLD CODE MURDER 2ND DEGREE","CONSPIRACY MURDER 1ST DEGREE","CONSPIRACY MURDER 2ND DEGREE","FACILITATION MURDER 1ST DEGREE","FACILITATION MURDER 2ND DEGREE","MURDER","MURDER 1ST DEGREE","MURDER 2ND DEGREE","MURDER SECOND DEGREE","SOLICITATION MURDER 1ST DEGREE","SOLICITATION MURDER 2ND DEGREE"),
                                      Other = c("ABANDON/CONCEAL DEAD BODY","ADD HRMFUL SUBST FOOD/DRNK","ADD/NAME CHG SEX OFFENDER","AGG/MULTIPLE INS CODE VIOL","AGGRAVATED HARASSMENT","ALTER VEHICLE ID NUMBERS","ALTERING SERIAL OR ID NBR","ALTERING VEH SER ID NUMBER","ASSIST CRIM SYND/LEAD GANG","ATTEMPT TO COMMIT","ATTEMPT TO COMMIT ABANDON/CONCEAL DEAD BODY","ATTEMPT TO COMMIT ADD/NAME CHG SEX OFFENDER","ATTEMPT TO COMMIT AGG/MULTIPLE INS CODE VIOL","ATTEMPT TO COMMIT AGGRAVATED HARASSMENT","ATTEMPT TO COMMIT ALTER VEHICLE ID NUMBERS","ATTEMPT TO COMMIT ALTERING SERIAL OR ID NBR","ATTEMPT TO COMMIT ALTERING VEH SER ID NUMBER","ATTEMPT TO COMMIT ASSIST CRIM SYND/LEAD GANG","ATTEMPT TO COMMIT BIGAMY","ATTEMPT TO COMMIT BRIBE PUB SERV/PARTY OFCR","ATTEMPT TO COMMIT COMPUTER TAMPERING","ATTEMPT TO COMMIT CONDUCTING A CHOP SHOP","ATTEMPT TO COMMIT CONSPIRACY","ATTEMPT TO COMMIT DANG. CRIMES AG. CHILDREN","ATTEMPT TO COMMIT DISORDERLY CONDUCT","ATTEMPT TO COMMIT DOG FIGHTING","ATTEMPT TO COMMIT EXTORTION THREAT TO INFORM","ATTEMPT TO COMMIT FLIGHT FROM LAW VEHICLE","ATTEMPT TO COMMIT HARASSMENT","ATTEMPT TO COMMIT HOAX","ATTEMPT TO COMMIT ILLEGAL CONTROL ENTERPRISE","ATTEMPT TO COMMIT ILLEGAL VOTING VIOLATION","ATTEMPT TO COMMIT INFLUENCE A WITNESS","ATTEMPT TO COMMIT INTERCEPT COMMUNICATION","ATTEMPT TO COMMIT INTERF MONITOR DEVICE","ATTEMPT TO COMMIT INTERFER W/JUDICIAL PROCES","ATTEMPT TO COMMIT KILL,SELL,BUY LIVESTOCK","ATTEMPT TO COMMIT LEAVE ACCIDENT DEATH INJRY","ATTEMPT TO COMMIT MEDICAL VIOLATIONS","ATTEMPT TO COMMIT MONEY LAUNDERING","ATTEMPT TO COMMIT OBSTRUCT CRIM INVEST/PROSC","ATTEMPT TO COMMIT PART CRIMINAL STREET GANG","ATTEMPT TO COMMIT PERJURY","ATTEMPT TO COMMIT PROMOTION OF GAMBLING","ATTEMPT TO COMMIT SMUGGLING","ATTEMPT TO COMMIT STALKING","ATTEMPT TO COMMIT SURREPT RECORD","ATTEMPT TO COMMIT TAKING PROHB ARTICLES JAIL","ATTEMPT TO COMMIT TAMPER W PHYSICAL EVIDENCE","ATTEMPT TO COMMIT TAMPERING W WITNESS","ATTEMPT TO COMMIT TATTS/PRC MNR W/O CONSENT","ATTEMPT TO COMMIT TRADING IN PUBLIC OFFICE","ATTEMPT TO COMMIT TRAFFICKING IN STOLEN PROP","ATTEMPT TO COMMIT UNLAWFL VW/TAPE/REC PERS","ATTEMPT TO COMMIT UNREG TELEPHN SOLICITATION","ATTEMPT TO COMMIT VEHICLE VIN VIOLATION","ATTEMPT//OLD CODE","ATTEMPT//OLD CODE ADD/NAME CHG SEX OFFENDER","ATTEMPT//OLD CODE AGGRAVATED HARASSMENT","ATTEMPT//OLD CODE ASSIST CRIM SYND/LEAD GANG","ATTEMPT//OLD CODE CONDUCTING A CHOP SHOP","ATTEMPT//OLD CODE FALSE SWEARING","ATTEMPT//OLD CODE FLIGHT FROM LAW VEHICLE","ATTEMPT//OLD CODE ILLEGAL CONTROL ENTERPRISE","ATTEMPT//OLD CODE INFLUENCE A WITNESS","ATTEMPT//OLD CODE INTERF MONITOR DEVICE","ATTEMPT//OLD CODE KILL,SELL,BUY LIVESTOCK","ATTEMPT//OLD CODE LEAVE ACCIDENT DEATH INJRY","ATTEMPT//OLD CODE MONEY LAUNDERING","ATTEMPT//OLD CODE OBSCENE MATERIAL VIOLATION","ATTEMPT//OLD CODE OBSTRUCT CRIM INVEST/PROSC","ATTEMPT//OLD CODE SMUGGLING","ATTEMPT//OLD CODE SURREPT RECORD","ATTEMPT//OLD CODE TRAFFICKING IN STOLEN PROP","AWOL CCC FURLOUGH","BIGAMY","BRANDING/ALTERING BRAND","BRIBE PUB SERV/PARTY OFCR","BRIBERY OF PARTIC SPORTS","CAUSE DEATH W/VEHICLE","CHILD NEGLECT","CNTRFEIT MARKS EFF 8-21-98","COMMERCIAL BRIBERY",
                                                "COMPOUNDING CRIME","COMPUTER TAMPERING","CONDUCTING A CHOP SHOP","CONSPIRACY","CONSPIRACY ASSIST CRIM SYND/LEAD GANG","CONSPIRACY BRIBE PUB SERV/PARTY OFCR","CONSPIRACY CRIME AGAINST NATURE","CONSPIRACY FLIGHT FROM LAW VEHICLE","CONSPIRACY ILLEGAL CONTROL ENTERPRISE","CONSPIRACY INFLUENCE A WITNESS","CONSPIRACY MONEY LAUNDERING","CONSPIRACY OBSCENE PRINTS AND ARTICLE","CONSPIRACY OBSTRUCT CRIM INVEST/PROSC","CONSPIRACY PART CRIMINAL STREET GANG","CONSPIRACY PERJURY","CONSPIRACY SMUGGLING","CONSPIRACY TAMPER W PHYSICAL EVIDENCE","CONSPIRACY TAMPER W PUBLIC RECORD","CONSPIRACY TAMPERING W WITNESS","CONSPIRACY TERRORISM","CONSPIRACY TRAFFICKING IN STOLEN PROP","CONTEMPT OF COURT","CONTIRBUTE DELIQ MINOR","CONTRACTING W/OUT LICENSE","CRIME AGAINST NATURE","CRIMINAL VIOLATION","CRUELTY TO ANMLS/POULTRY","DISORDERLY CONDUCT","EXTORTION THREAT TO INFORM","FACILITATION","FACILITATION ASSIST CRIM SYND/LEAD GANG","FACILITATION COMPUTER TAMPERING","FACILITATION CONSPIRACY","FACILITATION ILLEGAL CONTROL ENTERPRISE","FACILITATION MONEY LAUNDERING","FACILITATION PART CRIMINAL STREET GANG","FACILITATION PERMISSIBLE INFERENCES","FACILITATION SMUGGLING","FACILITATION TRAFFICKING IN STOLEN PROP","FAIL TO GIVE INFO/AID ACCI","FAILURE PARNT PROVIDE CHLD","FAILURE TO RPT ABUSE-MINOR","FALSE INSTRUMNT FOR FILING","FALSE OR FORGED MESSAGES","FALSE REGISTRATION","FALSE REPORT;EMERG RESPONS","FALSE STATEMENT","FALSE SWEARING","FLIGHT FROM LAW VEHICLE","GAME AND FISH VIOLATIONS","HARASSMENT","HAZARDOUS WASTE VIOLATION","HIT AND RUN WITH INJURIES","HOAX","ILLEGAL CONTROL ENTERPRISE","IMPORT/RELEASE LIVE WILDLF","INFLUENCE A WITNESS","INFLUENCING A JUROR","INTERCEPT COMMUNICATION","INTERF MONITOR DEVICE","INTERFER W/JUDICIAL PROCES","INTERFER W/WORKING ANIMAL","INTERFERE W/EDUC INSTITUTE","INTRFR W/PUB SFTY TRANSMIS","JURY TAMPERING","KILL,SELL,BUY LIVESTOCK","LEAVE ACCIDENT DEATH INJRY","LEAVE ACCIDENT WATERCRAFT","LICENSING","MEDICAL VIOLATIONS","MISCONDUCT BY A JUROR","MONEY LAUNDERING","OBSCENE MATERIAL VIOLATION","OBSTRUCT CRIM INVEST/PROSC","OFFENSE COMMIT ON RELEASE","ORDER OF PROTECT VIOLATION","PARENT FAILS SUPPORT >1996","PART CRIMINAL STREET GANG","PERJURY","POSS.OF INTERCEPT DEVICE","PRESENCE AT DOG FIGHTING","PROMOTION OF GAMBLING","PUB OFFCL CONFLCIT OF INTR","PUBLIC DISPLAY OBSCEN MTRL","RACING ON HIGHWAYS","RECEIVING BRIBE BY WITNESS","SALE/PUR CHILD EFF 8-21-98","SECURE OFFENSE PROCEEDS","SENTENCE OF IMPRISIONMENT","SMUGGLING","SOLICITATION","SOLICITATION ASSIST CRIM SYND/LEAD GANG","SOLICITATION BRIBE PUB SERV/PARTY OFCR","SOLICITATION COMPUTER TAMPERING","SOLICITATION CONDUCTING A CHOP SHOP","SOLICITATION HOAX","SOLICITATION ILLEGAL CONTROL ENTERPRISE","SOLICITATION INTERF MONITOR DEVICE","SOLICITATION MONEY LAUNDERING","SOLICITATION PART CRIMINAL STREET GANG","SOLICITATION PERJURY","SOLICITATION SMUGGLING","SOLICITATION SOLICITATION","SOLICITATION TAMPERING W WITNESS","SOLICITATION TRAFFICKING IN STOLEN PROP","STALKING","SURREPT RECORD","TAKING PROHB ARTICLES JAIL","TAMPER W PHYSICAL EVIDENCE","TAMPER W PUBLIC RECORD","TAMPERING W WITNESS","TATTS/PRC MNR W/O CONSENT","TRAFFICKING IN STOLEN PROP","UNAUTH ACCESS TO CRIM HIST","UNLAWFL VW/TAPE/REC PERS","UNLAWFUL ACTS","UNLAWFUL ALCOHOL ACTS","UNLAWFUL DISTR OF IMAGES","UNLWFL KILL LIVESTOCK","UNSWORN FALSIFICATION","VEHICLE VIN VIOLATION","WATER QUALITY VIOLATION"),
                                      Robbery =c("AGGRAVATED ROBBERY","ARMED ROBBERY","ATTEMPT TO COMMIT AGGRAVATED ROBBERY","ATTEMPT TO COMMIT ARMED ROBBERY","ATTEMPT TO COMMIT ROBBERY","ATTEMPT//OLD CODE AGGRAVATED ROBBERY","ATTEMPT//OLD CODE ARMED ROBBERY","ATTEMPT//OLD CODE ROBBERY","CONSPIRACY AGGRAVATED ROBBERY","CONSPIRACY ARMED ROBBERY","CONSPIRACY ROBBERY","FACILITATION AGGRAVATED ROBBERY","FACILITATION ARMED ROBBERY","FACILITATION ROBBERY","ROBBERY","SOLICITATION AGGRAVATED ROBBERY","SOLICITATION ARMED ROBBERY","SOLICITATION ROBBERY"),
                                      SexualOffense_SexualOffenseAgainstMinor =c("ATTEMPT TO COMMIT PANDERING","ATTEMPT//OLD CODE PANDERING","ATTEMPT TO COMMIT FAIL TO REG AS SEX OFFNDR","ATTEMPT TO COMMIT KEEP/RESIDE HSE PROSTITUTN","ATTEMPT TO COMMIT PROSTITUTION","ATTEMPT TO COMMIT PUBLIC SEXUAL INDECENCY","ATTEMPT TO COMMIT RECEIVE PROSTIT EARNINGS","ATTEMPT TO COMMIT SEX OFFENDER REG VIOL","ATTEMPT TO COMMIT SEX TRAFFICKING","ATTEMPT TO COMMIT SEXUAL ABUSE","ATTEMPT TO COMMIT SEXUAL ASSAULT","ATTEMPT TO COMMIT TRANSPORT FOR PROSTITUTION","ATTEMPT TO COMMIT UNLWFL SX CNDCT CORR/PRIS","ATTEMPT TO COMMIT VOYEURISM","ATTEMPT//OLD CODE FAIL TO REG AS SEX OFFNDR","ATTEMPT//OLD CODE PROSTITUTION","ATTEMPT//OLD CODE PUBLIC SEXUAL INDECENCY","ATTEMPT//OLD CODE SEX OFFENDER REG VIOL","ATTEMPT//OLD CODE SEX TRAFFICKING","ATTEMPT//OLD CODE SEXUAL ABUSE","ATTEMPT//OLD CODE SEXUAL ASSAULT","CONSPIRACY SEXUAL ABUSE","CONSPIRACY SEXUAL ASSAULT","ENTICE PRSN FOR PROSTITUTN","FACILITATION PART/ASSIST HUMAN SMUGGLNG","FAIL TO REG AS SEX OFFNDR","INCEST","INDECENT EXPOSURE","KEEP/RESIDE HSE PROSTITUTN","PANDERING","PART/ASSIST HUMAN SMUGGLNG","PLACE IN HOUSE OF PROSTIT","PROCURE FLSLY FOR PROSTITN","PROSTITUTION","PUBLIC SEXUAL INDECENCY","RECEIVE PROSTIT EARNINGS","SEX MISCONDUCT HLTH PROF","SEX OFFENDER REG VIOL","SEX TRAFFICKING","SEXUAL ABUSE","SEXUAL ASSAULT","SEXUAL ASSAULT OF SPOUSE","SOLICITATION SEX OFFENDER REG VIOL","SOLICITATION SEXUAL ASSAULT","TRAFFICKING OF PERSONS","TRANSPORT FOR PROSTITUTION","UNLWFL SX CNDCT CORR/PRIS","VOYEURISM", "AG LURING MINOR SX EXPLOIT","ATTEMPT TO COMMIT AG LURING MINOR SX EXPLOIT","ATTEMPT TO COMMIT CHILD PROSTITUTION","ATTEMPT TO COMMIT COMM SEX EXPLOIT OF MINOR","ATTEMPT TO COMMIT CONTIN SEXUAL ABUSE CHILD","ATTEMPT TO COMMIT FURNISH OBSC MTRL TO MINOR","ATTEMPT TO COMMIT LURE MINOR FOR SEX EXPLOIT","ATTEMPT TO COMMIT MOLESTATION OF CHILD","ATTEMPT TO COMMIT OBSCENE FILM/PHOTO MINORS","ATTEMPT TO COMMIT SEX EXPLOIT OF MINOR","ATTEMPT TO COMMIT SEXUAL CONDUCT W MINOR","ATTEMPT//OLD CODE CHILD PROSTITUTION","ATTEMPT//OLD CODE CONTIN SEXUAL ABUSE CHILD","ATTEMPT//OLD CODE FURNISH OBSC MTRL TO MINOR","ATTEMPT//OLD CODE LURE MINOR FOR SEX EXPLOIT","ATTEMPT//OLD CODE MOLESTATION OF CHILD","ATTEMPT//OLD CODE SEX EXPLOIT OF MINOR","ATTEMPT//OLD CODE SEXUAL CONDUCT W MINOR","CHILD PROSTITUTION","COMM SEX EXPLOIT OF MINOR","CONSPIRACY CHILD PROSTITUTION","CONSPIRACY MOLESTATION OF CHILD","CONSPIRACY SEX EXPLOIT OF MINOR","CONSPIRACY SEXUAL CONDUCT W MINOR","CONTIN SEXUAL ABUSE CHILD","FACILITATION LURE MINOR FOR SEX EXPLOIT","FACILITATION SEX EXPLOIT OF MINOR","FURNISH OBSC MTRL TO MINOR","LURE MINOR FOR SEX EXPLOIT","MOLESTATION OF CHILD","OBSCENE FILM/PHOTO MINORS","PERMISSIBLE INFERENCES","SEX EXPLOIT OF MINOR","SEXUAL CONDUCT W MINOR","SOLICITATION CHILD PROSTITUTION","SOLICITATION FURNISH OBSC MTRL TO MINOR","SOLICITATION LURE MINOR FOR SEX EXPLOIT","SOLICITATION MOLESTATION OF CHILD","SOLICITATION SEX EXPLOIT OF MINOR","SOLICITATION SEXUAL CONDUCT W MINOR"),
                                      Shock =c("SHOCK INCARCERATION"),
                                      WeaponsOffense =c("ATTEMPT TO COMMIT DEPOSITING EXPLOSIVES","ATTEMPT TO COMMIT FIREARM POSS-ADJUD DELIQNT","ATTEMPT TO COMMIT MISCNDCT INVOLVING WEAPONS","ATTEMPT TO COMMIT WEAPONS & EXPLOSIVES (DEF)","ATTEMPT TO COMMIT WEAR BDY ARMR DURING FELNY","ATTEMPT//OLD CODE MISCNDCT INVOLVING WEAPONS","CONSPIRACY MISCNDCT INVOLVING WEAPONS","DEPOSITING EXPLOSIVES","FACILITATION MISCNDCT INVOLVING WEAPONS","FIREARM POSS-ADJUD DELIQNT","FIREARM TO MINOR","INTRO DRUG/WPN TO SEC FACL","MINOR WITH FIREARM","MISCNDCT INVOLVING WEAPONS","MISCNDCT SIMULTD EXPLSV DV","POSS DEADLY WPN INTN ASSLT","SOLICITATION MISCNDCT INVOLVING WEAPONS","SOLICITATION WEAPONS & EXPLOSIVES (DEF)","THREAT/USE STUN GUN","WEAPONS & EXPLOSIVES (DEF)","WEAR BDY ARMR DURING FELNY"),
                                      Blank =c(""),
                                      Interstate = c("INTERSTATE CORR.COMPACT"))

"Combined: Domestic Violence & Child_Adult Abuse = domestic"
"Combined: Burglary_CriminalTrespass & Criminal Damage & Theft = property"
"Combined: Drug Offense & MarijuanaOnly = drugs"
"Combined: Murder & Manslaughter_NegligentHomicide = homicide"
"Combined: SexualOffense & SexualOffense_AgainstMinor = sexual"
"Combined: Fraud & Forgery_IdentityTheft = fraud"

#levels(DSC_clean.4$Crime_Collapse)
# 17 levels

#summary(DSC_clean.4$Crime_Collapse)
"4/12/23 -- 2:42pm: There are 9 in the NA section & 8 in the Blank category"
"4/13/23: 9 in the NA section & 8 in the Blank category"
"Interstate: 289"

#table(DSC_clean.4$Crime_Collapse)
"8 in the Blank category"
"289 Interstate"

#summary(DSC_clean.4)
"Crime_Factor & Crime_Collapse have 9 NA's"
"Remove them"


"////////////////////// Create Crime Dummy Variables /////////////////////////////////////////////////"

# Create the Crime Dummy variable
DSC_clean.4$arson <- ifelse(DSC_clean.4$Crime_Collapse == "Arson", 1, 0)
DSC_clean.4$assault <- ifelse(DSC_clean.4$Crime_Collapse == "Assault", 1, 0)
DSC_clean.4$domestic <- ifelse(DSC_clean.4$Crime_Collapse == "DomesticViolence_ChildAdultAbuse", 1, 0)
DSC_clean.4$drugs <- ifelse(DSC_clean.4$Crime_Collapse == "DrugOffenses_All", 1, 0)
DSC_clean.4$dui <- ifelse(DSC_clean.4$Crime_Collapse == "DUI", 1, 0)
DSC_clean.4$escape <- ifelse(DSC_clean.4$Crime_Collapse == "Escape", 1, 0)
DSC_clean.4$fraud <- ifelse(DSC_clean.4$Crime_Collapse == "Fraud_Frogery_IdentityTheft", 1, 0)
DSC_clean.4$homicide <- ifelse(DSC_clean.4$Crime_Collapse == "Murder_Manslaughter_NegligentHomicide", 1, 0)
DSC_clean.4$kidnap <- ifelse(DSC_clean.4$Crime_Collapse == "Kidnapping", 1, 0)
DSC_clean.4$other <- ifelse(DSC_clean.4$Crime_Collapse == "Other", 1, 0)
DSC_clean.4$property <- ifelse(DSC_clean.4$Crime_Collapse == "Burglary_CriminalTrespass_Theft_CriminalDamage", 1, 0)
DSC_clean.4$robbery <- ifelse(DSC_clean.4$Crime_Collapse == "Robbery", 1, 0)
DSC_clean.4$sexual <- ifelse(DSC_clean.4$Crime_Collapse == "SexualOffense_SexualOffenseAgainstMinor", 1, 0)
DSC_clean.4$shock <- ifelse(DSC_clean.4$Crime_Collapse == "Shock", 1, 0)
DSC_clean.4$weapons <- ifelse(DSC_clean.4$Crime_Collapse == "WeaponsOffense", 1, 0)
DSC_clean.4$blank <- ifelse(DSC_clean.4$Crime_Collapse == "Blank", 1, 0)
DSC_clean.4$interstate <- ifelse(DSC_clean.4$Crime_Collapse == "Interstate", 1, 0)


"66 variables - 18 variables added" 

#summary(DSC_clean.4)
# 566,690 observations & 74 variables
"4/12/23: The only issue now is that there are 9 NA's in all the crime dummies"
"Admission: 959 NA's & Prison.Release.Date: 10,008 NA's"

"//////////////////////// Remove Observations If Missing Admission & PRD //////////////////////////////////////////////////////"

"Remove inmates if BOTH their Admission AND Prison.Release.Date (current incarceration) are missing"
"Admission: 959 NA's & Prison.Release.Date: 10,008 NA's"
# Identify rows with missing information in both columns
missing_rows.v2 <- which(is.na(DSC_clean.4$Admission) & is.na(DSC_clean.4$Prison.Release.Date))

# Remove rows with missing information in both columns
DSC_clean.5 <- DSC_clean.4[-missing_rows.v2, ]

#summary(DSC_clean.5)

"/////////////////// Remove Inmates With Missing Admission, PRD, & Crime Information ///////////////////// "
missing_rows.1.v3 <- which(is.na(DSC_clean.5$Admission) | is.na(DSC_clean.5$Prison.Release.Date)| is.na(DSC_clean.5$Crime_Factor))
# Remove rows with missing information in those 3 columns
DSC_clean.6 <- DSC_clean.5[-missing_rows.1.v3, ]
"Before: 565,763 obs."
"After: 556,641 obs."
"9122 observations removed"

#summary(DSC_clean.6)
"0 NA's for Admission"
"0 NA's for Prison Release Date"
"0 NA's for Crime Factor & Crime Collapse i.e., all the crime categories"


"//////////////////////// Remove Irrelevant Variables/Columns //////////////////////////////////////////////////////"

"Remove irrelevant variables"
DSC_clean.7 <- subset(DSC_clean.6, select = -c(Height..inches., Weight, Ethnic.Origin, Custody.Class, Inmate.Detainee,
                                               Commitment.Status, Status,Sentence.yy.mm.dd.x, Sentence.Status, Years, Months, Days))
"556,641 obs. & 54 variables"

#summary(DSC_clean.7$Crime_Collapse)
# 40 Interstate

"//////////////////////// Remove Interstate & Blank Crime Categories //////////////////////////////////////////////////////"
"There are 40 observations labled as Interstate -- Remove them"
DSC_clean.8 <- subset(DSC_clean.7, Crime_Collapse!= "Interstate" & Crime_Collapse!= "Blank")

#summary(DSC_clean.8)
"556,593 observations & 54 variables"


"//////////////////////// Remove Interstate & Blank Crime Categories //////////////////////////////////////////////////////"

"Remove irrelevant variables"
DSC_clean.9 <- subset(DSC_clean.8, select = -c(interstate, blank))
"556,596 obs. & 55 variables"

"/////////////////// Create 'Prior Incarcerations Dummy Variable' Variable /////////////////////////////////"
"Rename Data Set"
DSC.1 <- DSC_clean.9
"556,593 obs. & 52 variables"

# Create the priors indicator -- If Admit.Date is earlier than Admission, (current offense) it means the inmate has a prior incarceration, i.e., equal 1
DSC.1$priors_dv <- ifelse(DSC.1$Admit.Date < DSC.1$Admission, 1,0)
"556,593 obs. & 53 variables"

#table(DSC.1$priors_dv)
"533,929 1s & 22,664 0s"
"95.93% have a prior incarceration"
"4.07% do NOT have at least one prior incarceration"

"/////////////////// Create 'Projected Time Served' Variable for Most Recent Crime Committed /////////////////////////////////"
"/////////////////// Create 'Time Served Category' for Most Recent Crime Committed /////////////////////////////////"

# Use the dplyr package
#library(dplyr)

# I think the years variable will work best -- now to figure out what to do with the negative & super long life sentences?
# Remove negative but keep the super large life sentences?
# Negatives are due to incorrect web scrape/importation of data -- ID 83827 - negative because imported incorrectly. Max End Date & PRD got swapped"
#ID 108210 - negative because imported incorrectly. Max End Date & PRD got swapped

"Create the Proj_ts & TS_Category variables"
# Create the breaks to include the min & max values of proj_ts_years
DSC.1 <- DSC.1 %>%
  mutate(projected_ts_years = as.numeric(difftime(Prison.Release.Date, Admission, units = "weeks")) / 52)

min_val <- min(DSC.1$projected_ts_years, na.rm = TRUE)
max_val <- max(DSC.1$projected_ts_years, na.rm = TRUE)

breaks <- c(-Inf, 3, 7, 10, 15, 20, 24, Inf)

DSC.1 <- DSC.1 %>%
  mutate(ts_category = cut(projected_ts_years, 
                                    breaks = breaks,
                                    labels = c("0-3 years", "4-7 years", "8-10 years", "11-15 years", "16-20 years", "21-24 years", "25+ years"),
                                    include.lowest = TRUE))
# Note: the categorical time served variable is a string & no longer numeric
"556,593 obs. & 55 vars."

summary(DSC.1)
"projected_ts_years: min = -23.904"
"time_served_category: NA's = 0"
"time_served_category: (Other) = 0"

#table(DSC.1$projected_ts_years)
#table(DSC.1$time_served_category)
"0-3 years   4-7 years  8-10 years 11-15 years 16-20 years 21-24 years   25+ years 
     291917      165970       44773       26591       10901        4294       12147"
# = 545,692 -- 556593-545692 = 10,901 NA's or Other -- Check!



"Questions/Concerns WRT the Data"
"Remove inmates with less than 1 year because technically not in prison??"
"What to do with sentences that are 7.1 years, etc because instead of being in the 4-7 year category it automatically goes to the 8-10years"
"Breaks = 0, 3.99, 7.99, 10.99??? Or keep as is??"

"5/25/26 -- Update: Start out by simply using the projected_ts_years variable then work with the category ones later - the years var. works for now & can change after made more progress"
"Keep inmates that have less than one year of current projected ts because they likely have a criminal history & infractions history that is beneficial to keep for my reserach question"


"/////////////////// View & Remove Inmates With Negative Projected TS  /////////////////////////////////"
# Create subset of negative projected time served
negative_proj_ts <- DSC.1[DSC.1$projected_ts_years < 0, ]
"863 obs. have a negative projected ts"

# Create new data frame excluding negative projected time served inmates
DSC.2 <- DSC.1[!(DSC.1$projected_ts_years < 0), ]
"555,730 obs & 55 vars. -- 863 obs. removed "



#summary(negative_proj_ts)
#table(negative_proj_ts$Release.Type)
"ABS. DISCHARGE  DRUG TRANS REL    OVERCROWDING REC.FM.OVCROWDG   RECEIVED FROM    RECOMMITMENT 
              2             607              65              18              24               4 
RELEASEE ABSCND TRANS/RET INTER 
            140               3"

"5/25/23 - Update"
"Just looking at inmate 89032 - I can see that he has 16 infraction violations, should I remove these inmates?"
"Have incorrect Admission & Prison Rel. Dates"
"Inmate ID 108854 has 17 infractions -- remove neverthless"
"Or would removing them be ok because all of their observations arent being removed? Just the ones with their negative sentences? Or are all of them showing negative so they'll all be removed"
"5/26/23: It's best to remove these inmates because their admission & PRD information were imported incorrectly"

summary(DSC.2)
"projected_ts_years: min = 0.000"
"time_served_category: NA's = 0"
"time_served_category: (Other) = 0"


"/////////////////// Create A Pie Chart For Proj. TS Categories  /////////////////////////////////"
#Create a Pie Chart representing the % of the inmate population in each ts category
#install.packages(ggplot2) - this command did not work so had to install manually
library(ggplot2)

pie_chart <- ggplot(DSC.2, aes(x = "", fill = ts_category)) +
  geom_bar(width = 1, stat = "count") +
  coord_polar(theta = "y") +
  labs(fill = "Time Served Category") +
  ggtitle("Distribution of Time Served Categories") +
  theme_minimal() +
  geom_text(aes(label = paste0(sprintf("%.2f", (after_stat(count) / sum(after_stat(count))) * 100), "%")),
            stat = "count", position = position_stack(vjust = 0.5))

print(pie_chart)
"The only issue is that there is scientific notation around the perimeter & then its sloppy where the categories have small numbers/slices & are smushed together & looks sloppy"
#####

"/////////////////// Create A Recidivism Variable /////////////////////////////////"

# Sort the data set by inmate ID and Release date in descending order
#DSC.3 <- DSC.2[order(DSC.2$ID, DSC.2$Release.Date.s., decreasing = TRUE), ]


# Create the recidivism variable
#DSC.3$recidivate <- as.integer(DSC.2$priors_dv == 1 & (DSC.2$Release.Date.s. > DSC.2$Admission) & ((DSC.2$Release.Date.s. - DSC.2$Admission) <= 36*30.44))
"Does NOT work correctly"
# About 44% of the inmate population recidivates but there are 251,747 that are NA, i.e., not assigned a 1 or 0. Why?

"Leave this variable alone for now & move on to merging the DSC & Infractions_5 data sets "
#####

"/////////////////// Number of Obs. & Number of Individuals/Inmates /////////////////////////////////"
# How many individuals/inmates are in the data set?
#library(dplyr)

#DSC.2 %>%
 # summarize(n_obs = n(),
       #     n_inmates = n_distinct(ID))
"555,730 obs. & 221,703 inmates"

"//////////////////////// Remove Irrelevant Variables/Columns //////////////////////////////////////////////////////"
# Remove irrelevant variables
DSC.3 <- subset(DSC.2, select = -c(Gender, Max.End.Date, Cur..Absconded, Hist..Absconded, Release.Type, Most.Recent.Loc, Unit, Community.Supervision.Parole,
                                 Last.Movement, Commit., Court.Cause., Crime, Crime.Info, Felony.Class, Supervision.End, Sentence.Expiration, Flat.Maximum, Crime_Factor, Crime_Collapse))
"555,730 obs. & 36 variables"


"//////////////////// Save As R Data File ///////////////////////////////////////////////////"

"Rename the dataset"
Master_DSC_Final_v2iii <- DSC.3
"555,730 obs. & 36 variables"

"Save desired file path as an object"
filepath <- file.path("D:/PhD/Research!/Male_Female/Empirical/AZMergedDemoSentenceCrime_MF/Originals/gary_CopyCSV_MF")


"Save this Master File of the DemoSentenceCrime Data Set"
save(Master_DSC_Final_v2iii , file = file.path(filepath, "Master_DSC_Final_v2iii.RData"))





























